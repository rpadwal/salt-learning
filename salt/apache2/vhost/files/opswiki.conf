<VirtualHost *:80>
    ServerName dokuwiki.entrata.com
    ServerAlias opswiki.propertysolutions.com
    ServerAlias dokuwiki.propertysolutions.com
    RedirectMatch 301 (.*) https://opswiki.entrata.com$1
</VirtualHost>

<VirtualHost *:80>
    ServerName opswiki.entrata.com
    DocumentRoot '/var/www/opswiki'

    <Directory /var/www/opswiki>
        Require all granted
        AllowOverride All
    </Directory>

    ## Enable this to restrict editing to logged in users only

    ## You should disable Indexes and MultiViews either here or in the
    ## global config. Symlinks maybe needed for URL rewriting.
    #Options -Indexes -MultiViews +FollowSymLinks

    ## make sure nobody gets the htaccess, README, COPYING or VERSION files
    #<Files ~ "^([\._]ht|README$|VERSION$|COPYING$)">
    #   Require all denied
    #</Files>

    ## Uncomment these rules if you want to have nice URLs using
    ## $conf['userewrite'] = 1 - not needed for rewrite mode 2
    #RewriteEngine on
    #
    #RewriteRule ^/_media/(.*)  %{DOCUMENT_ROOT}/lib/exe/fetch.php?media=$1  [QSA,L,R]
    #RewriteRule ^/_detail/(.*) %{DOCUMENT_ROOT}/lib/exe/detail.php?media=$1  [QSA,L,R]
    #RewriteRule ^/_export/([^/]+)/(.*) %{DOCUMENT_ROOT}/doku.php?do=export_$1&id=$2  [QSA,L]
    #RewriteRule ^/$ %{DOCUMENT_ROOT}/doku.php [L]
    #RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
    #RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
    #RewriteRule (.*) /doku.php?id=$1  [QSA,L]

    #
    ## Not all installations will require the following line.  If you do,
    ## change "/dokuwiki" to the path to your dokuwiki directory relative
    ## to your document root.
    #RewriteBase /dokuwiki
    #
    ## If you enable DokuWikis XML-RPC interface, you should consider to
    ## restrict access to it over HTTPS only! Uncomment the following two
    ## rules if your server setup allows HTTPS.
    #RewriteCond %{HTTPS} !=on
    #RewriteRule ^lib/exe/xmlrpc.php$      https://%{SERVER_NAME}%{REQUEST_URI} [L,R=301]

    RewriteEngine On
    RewriteCond %{HTTPS} !=on
    RewriteRule ^/?(.*) https://%{SERVER_NAME}/$1 [R,L]

</VirtualHost>

<VirtualHost *:443>
    ServerName dokuwiki.entrata.com
    ServerAlias opswiki.propertysolutions.com
    ServerAlias dokuwiki.propertysolutions.com
    RedirectMatch 301 (.*) https://opswiki.entrata.com$1
</VirtualHost>

<VirtualHost *:443>
    ServerName opswiki.entrata.com
    DocumentRoot '/var/www/opswiki'

    <Directory /var/www/opswiki>
        Require all granted
        AllowOverride All
    </Directory>

    ## Enable this to restrict editing to logged in users only

    ## You should disable Indexes and MultiViews either here or in the
    ## global config. Symlinks maybe needed for URL rewriting.
    #Options -Indexes -MultiViews +FollowSymLinks

    ## make sure nobody gets the htaccess, README, COPYING or VERSION files
    #<Files ~ "^([\._]ht|README$|VERSION$|COPYING$)">
    #    Require all denied
    #</Files>

    ## Uncomment these rules if you want to have nice URLs using
    ## $conf['userewrite'] = 1 - not needed for rewrite mode 2
    #RewriteEngine on
    #
    #RewriteRule ^/_media/(.*)  %{DOCUMENT_ROOT}/lib/exe/fetch.php?media=$1  [QSA,L,R]
    #RewriteRule ^/_detail/(.*) %{DOCUMENT_ROOT}/lib/exe/detail.php?media=$1  [QSA,L,R]
    #RewriteRule ^/_export/([^/]+)/(.*) %{DOCUMENT_ROOT}/doku.php?do=export_$1&id=$2  [QSA,L]
    #RewriteRule ^/$ %{DOCUMENT_ROOT}/doku.php [L]
    #RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
    #RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
    #RewriteRule (.*) /doku.php?id=$1  [QSA,L]

    #
    ## Not all installations will require the following line.  If you do,
    ## change "/dokuwiki" to the path to your dokuwiki directory relative
    ## to your document root.
    #RewriteBase /dokuwiki
    #
    ## If you enable DokuWikis XML-RPC interface, you should consider to
    ## restrict access to it over HTTPS only! Uncomment the following two
    ## rules if your server setup allows HTTPS.
    #RewriteCond %{HTTPS} !=on
    #RewriteRule ^lib/exe/xmlrpc.php$      https://%{SERVER_NAME}%{REQUEST_URI} [L,R=301]

    SSLEngine On
    SSLCertificateFile /etc/apache2/ssl/star.entrata.com.crt
    SSLCertificateChainFile /etc/apache2/ssl/networksolutions_bundle.crt
    SSLCertificateKeyFile /etc/apache2/ssl/star.entrata.com.key

</VirtualHost>
