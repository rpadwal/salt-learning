<VirtualHost *:80>
{% if salt['grains.get']('environment') == 'lcl' %}
  ServerName medialibrary.entratadev.com
  ServerAlias medialibrary.{{ salt['grains.get']('devuser') }}.entrata.lcl
{% else %}
  ServerName medialibrary.entrata.com
  ServerAlias medialibrary.propertysolutions.com
{%- endif %}

  ServerAdmin devops@xento.com

  DocumentRoot /srv/www/vhosts/Mounts

#  <Directory "/srv/www/vhosts/Mounts">
#    <LimitExcept GET POST HEAD OPTIONS>
#      Require all denied
#    </LimitExcept>
#    AllowOverride None
#    Options None
#    Require all granted
#  </Directory>

  <IfModule php5_module>
    php_value newrelic.appname "MediaLibrary {{ salt['grains.get']('track') }};MediaLibrary"
  </IfModule>

  <IfModule php7_module>
    php_value newrelic.appname "MediaLibrary {{ salt['grains.get']('track') }};MediaLibrary"
  </IfModule>

  <Files ~ "\.(gif|jpe?g|png|ico|pdf)$">
    Header set "Cache-Control" "max-age=31556952, public, must-revalidate"
    FileETag None
  </Files>

# Below commented to allow above cache changes - based on ticket #41910
#  Include /etc/apache2/conf-available/cache.conf
  Include /etc/apache2/conf-available/adminmedias.conf
  Include /etc/apache2/conf-available/callfiles.conf
  Include /etc/apache2/conf-available/globalmedias.conf
  Include /etc/apache2/conf-available/medialibrary.conf
  Include /etc/apache2/conf-available/taskattachments.conf
  Include /etc/apache2/conf-available/websitescache.conf

</VirtualHost>
