<VirtualHost *:80>
{% if salt['grains.get']('environment') == 'lcl' %}
  ServerName www.vendoraccessdev.com
  ServerAlias www.{{ salt['grains.get']('devuser') }}.vendoraccess.lcl
  ServerAlias *.vendoraccessdev.com
  ServerAlias *.{{ salt['grains.get']('devuser') }}.vendoraccess.lcl
{% else %}
  ServerName www.vendoraccess.com
  ServerAlias *.vendoraccess.com
{%- endif %}

  ServerAdmin webmaster@propertysolutions.com

  DocumentRoot /srv/www/vhosts/Entrata/www/Vendor/

  <Directory "/srv/www/vhosts/Entrata/www/Vendor/">
    <LimitExcept GET POST HEAD OPTIONS>
          Require all denied
    </LimitExcept>
    AllowOverride FileInfo Options
    Options None
    Require all granted
  </Directory>

  RewriteEngine on
  RewriteCond %{HTTP_HOST} ^vendoraccess.com [nocase]
  RewriteRule ^/(.*)$ http://www.vendoraccess.com/$1 [redirect=301]

  <IfModule php5_module>
    php_value newrelic.appname "Vendoraccess {{ salt['grains.get']('track') }};Vendoraccess"
  </IfModule>

  <IfModule php7_module>
    php_value newrelic.appname "Vendoraccess {{ salt['grains.get']('track') }};Vendoraccess"
  </IfModule>

  Include /etc/apache2/conf-available/common.conf

</VirtualHost>
