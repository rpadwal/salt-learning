# For detailed information about these directives see
# <URL:http://httpd.apache.org/docs/2.4/mod/mod_proxy_html.html>
# and for mod_xml2enc see
# <URL:http://httpd.apache.org/docs/2.4/mod/mod_xml2enc.html>
#

# All knowledge of HTML links has been removed from the mod_proxy_html
# code itself, and is instead read from httpd.conf (or included file)
# at server startup.  So you MUST declare it.  This will normally be
# at top level, but can also be used in a <Location>.
#
# Here's the declaration for W3C HTML 4.01 and XHTML 1.0

#ProxyHTMLLinks  a               href
#ProxyHTMLLinks  area            href
#ProxyHTMLLinks  link            href
#ProxyHTMLLinks  img             src longdesc usemap
#ProxyHTMLLinks  object          classid codebase data usemap
#ProxyHTMLLinks  q               cite
#ProxyHTMLLinks  blockquote      cite
#ProxyHTMLLinks  ins             cite
#ProxyHTMLLinks  del             cite
#ProxyHTMLLinks  form            action
#ProxyHTMLLinks  input           src usemap
#ProxyHTMLLinks  head            profile
#ProxyHTMLLinks  base            href
#ProxyHTMLLinks  script          src for

# To support scripting events (with ProxyHTMLExtended On),
# you'll need to declare them too.

#ProxyHTMLEvents onclick ondblclick onmousedown onmouseup \
#                onmouseover onmousemove onmouseout onkeypress \
#                onkeydown onkeyup onfocus onblur onload \
#                onunload onsubmit onreset onselect onchange

# First close Forward Proxy requests, as a security measure
ProxyRequests Off

# SAP Reverse Proxy config
{%- set proxy = {'virginia'    : 'http://10.17.18.218:8080/',
                 'ireland': 'https://sap-ireland.entrata.global/',
                 'lindon' : 'http://10.17.18.218:8080/',
                 'oregon' : 'https://sapdev.entrata.com/'} %}

{% if salt['grains.get']('environment') != 'lcl' %}
SSLProxyEngine on
ProxyPass "/sap/" "{{ proxy[grains.location]|default('http://127.0.0.1/') }}"
ProxyPassReverse "/sap/" "{{ proxy[grains.location]|default('http://127.0.0.1/') }}"
ProxyPassReverseCookiePath "/" "/sap/"
{% endif %}

# SAP_v1 Reverse Proxy config - Ticket # 58440
{%- set proxy_v1 = {'virginia': 'https://sap.entrata.com/',
                    'ireland' : 'https://sap-ireland.entrata.global/',
                    'lindon'  : 'https://sap.entrata.com/',
                    'oregon'  : 'https://sapdev.entrata.com/'} %}

{% if salt['grains.get']('environment') != 'lcl' %}
# SSLProxyEngine on # -- Already enabled --
ProxyPass "/sap_v1/" "{{ proxy_v1[grains.location]|default('http://127.0.0.1/') }}"
ProxyPassReverse "/sap_v1/" "{{ proxy_v1[grains.location]|default('http://127.0.0.1/') }}"
ProxyPassReverseCookiePath "/" "/sap_v1/"
{% endif %}
